<Project>

  <ItemGroup>
    <ProjectToBuild Include="$(RepoRoot)build.proj" />
    <!--
      Build pkgproj/depproj but not sfxproj. sfxproj requires pkgprojs to build their nupkgs first,
      before Restore, which doesn't seem supported by Arcade.
    -->
    <ProjectToBuild Include="$(RepoRoot)src\pkg\projects\**\*.pkgproj" />
    <ProjectToBuild Include="$(RepoRoot)src\pkg\projects\**\*.depproj" />
  </ItemGroup>

  <!--
    Use this extensibility point to build custom tasks during Build.proj, before any restoring or
    building happens in the repo. These DLLs would ideally live in Arcade and be restored as tools,
    so the idea is building them here is somewhat equivalent.

    Also create the host RID props file so the main build can use it statically.
  -->
  <Target Name="BuildRepoTools" BeforeTargets="Execute">
    <MSBuild
      Projects="$(RepoRoot)tools-local\tasks\core-setup.tasks.csproj"
      Properties="RepoRoot=$(RepoRoot)"
      Targets="
        Restore;
        Build;
        CreateHostMachineInfoFile"/>
  </Target>

</Project>
